<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>L-BFGS-B: src/setulb.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">L-BFGS-B
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">Large-scale Bound-constrained Optimization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('setulb_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">setulb.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="setulb_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a98990772aba60ae5986ecbbcc015ebed"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setulb_8f.html#a98990772aba60ae5986ecbbcc015ebed">setulb</a> (n, m, x, l, u, nbd, f, g, factr, pgtol, wa, iwa, task, iprint, csave, lsave, isave, dsave)</td></tr>
<tr class="memdesc:a98990772aba60ae5986ecbbcc015ebed"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine partitions the working arrays wa and iwa, and then uses the limited memory BFGS method to solve the bound constrained optimization problem by calling mainlb.  <a href="setulb_8f.html#a98990772aba60ae5986ecbbcc015ebed">More...</a><br /></td></tr>
<tr class="separator:a98990772aba60ae5986ecbbcc015ebed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a98990772aba60ae5986ecbbcc015ebed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98990772aba60ae5986ecbbcc015ebed">&#9670;&nbsp;</a></span>setulb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine setulb </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n)&#160;</td>
          <td class="paramname"><em>nbd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>factr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>pgtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(2*m*n + 5*n + 11*m*m + 8*m)&#160;</td>
          <td class="paramname"><em>wa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(3*n)&#160;</td>
          <td class="paramname"><em>iwa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*60&#160;</td>
          <td class="paramname"><em>task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iprint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character*60&#160;</td>
          <td class="paramname"><em>csave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(4)&#160;</td>
          <td class="paramname"><em>lsave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(44)&#160;</td>
          <td class="paramname"><em>isave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(29)&#160;</td>
          <td class="paramname"><em>dsave</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This subroutine partitions the working arrays wa and iwa, and then uses the limited memory BFGS method to solve the bound constrained optimization problem by calling mainlb. (The direct method will be used in the subspace minimization.)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>On entry n is the dimension of the problem.<br  />
 On exit n is unchanged.</td></tr>
    <tr><td class="paramname">m</td><td>On entry m is the maximum number of variable metric corrections used to define the limited memory matrix.<br  />
 On exit m is unchanged.</td></tr>
    <tr><td class="paramname">x</td><td>On entry x is an approximation to the solution.<br  />
 On exit x is the current approximation.</td></tr>
    <tr><td class="paramname">l</td><td>On entry l is the lower bound on x.<br  />
 On exit l is unchanged.</td></tr>
    <tr><td class="paramname">u</td><td>On entry u is the upper bound on x.<br  />
 On exit u is unchanged.</td></tr>
    <tr><td class="paramname">nbd</td><td>On entry nbd represents the type of bounds imposed on the variables, and must be specified as follows: nbd(i)=<ul>
<li>
0 if x(i) is unbounded, </li>
<li>
1 if x(i) has only a lower bound, </li>
<li>
2 if x(i) has both lower and upper bounds, and </li>
<li>
3 if x(i) has only an upper bound.</li>
</ul>
On exit nbd is unchanged.</td></tr>
    <tr><td class="paramname">f</td><td>On first entry f is unspecified.<br  />
 On final exit f is the value of the function at x.</td></tr>
    <tr><td class="paramname">g</td><td>On first entry g is unspecified.<br  />
 On final exit g is the value of the gradient at x.</td></tr>
    <tr><td class="paramname">factr</td><td>On entry factr &gt;= 0 is specified by the user. The iteration will stop when<br  />
 (f^k - f^{k+1})/max{|f^k|,|f^{k+1}|,1} &lt;= factr*epsmch<br  />
 where epsmch is the machine precision, which is automatically generated by the code.<br  />
 Typical values for factr:<ul>
<li>
1.d+12 for low accuracy; </li>
<li>
1.d+7 for moderate accuracy; </li>
<li>
1.d+1 for extremely high accuracy.</li>
</ul>
On exit factr is unchanged.</td></tr>
    <tr><td class="paramname">pgtol</td><td>On entry pgtol &gt;= 0 is specified by the user. The iteration will stop when<br  />
 max{|proj g_i | i = 1, ..., n} &lt;= pgtol<br  />
 where pg_i is the ith component of the projected gradient.<br  />
 On exit pgtol is unchanged.</td></tr>
    <tr><td class="paramname">wa</td><td>working array</td></tr>
    <tr><td class="paramname">iwa</td><td>working array</td></tr>
    <tr><td class="paramname">task</td><td>working string indicating the current job when entering and quitting this subroutine.</td></tr>
    <tr><td class="paramname">iprint</td><td>Must be set by the user. It controls the frequency and type of output generated:<ul>
<li>
iprint&lt;0 no output is generated; </li>
<li>
iprint=0 print only one line at the last iteration; </li>
<li>
0&lt;iprint&lt;99 print also f and |proj g| every iprint iterations; </li>
<li>
iprint=99 print details of every iteration except n-vectors; </li>
<li>
iprint=100 print also the changes of active set and final x; </li>
<li>
iprint&gt;100 print details of every iteration including x and g;</li>
</ul>
When iprint &gt; 0, the file iterate.dat will be created to summarize the iteration.</td></tr>
    <tr><td class="paramname">csave</td><td>working string</td></tr>
    <tr><td class="paramname">lsave</td><td>working array; On exit with 'task' = NEW_X, the following information is available:<ul>
<li>
If lsave(1) = .true. then the initial X has been replaced by its projection in the feasible set; </li>
<li>
If lsave(2) = .true. then the problem is constrained; </li>
<li>
If lsave(3) = .true. then each variable has upper and lower bounds;</li>
</ul>
</td></tr>
    <tr><td class="paramname">isave</td><td>working array; On exit with 'task' = NEW_X, the following information is available:<ul>
<li>
isave(22) = the total number of intervals explored in the search of Cauchy points; </li>
<li>
isave(26) = the total number of skipped BFGS updates before the current iteration; </li>
<li>
isave(30) = the number of current iteration; </li>
<li>
isave(31) = the total number of BFGS updates prior the current iteration; </li>
<li>
isave(33) = the number of intervals explored in the search of Cauchy point in the current iteration; </li>
<li>
isave(34) = the total number of function and gradient evaluations; </li>
<li>
isave(36) = the number of function value or gradient evaluations in the current iteration; </li>
<li>
if isave(37) = 0 then the subspace argmin is within the box; </li>
<li>
if isave(37) = 1 then the subspace argmin is beyond the box; </li>
<li>
isave(38) = the number of free variables in the current iteration; </li>
<li>
isave(39) = the number of active constraints in the current iteration; </li>
<li>
n + 1 - isave(40) = the number of variables leaving the set of active constraints in the current iteration; </li>
<li>
isave(41) = the number of variables entering the set of active constraints in the current iteration.</li>
</ul>
</td></tr>
    <tr><td class="paramname">dsave</td><td>working array; On exit with 'task' = NEW_X, the following information is available:<ul>
<li>
dsave(1) = current 'theta' in the BFGS matrix; </li>
<li>
dsave(2) = f(x) in the previous iteration; </li>
<li>
dsave(3) = factr*epsmch; </li>
<li>
dsave(4) = 2-norm of the line search direction vector; </li>
<li>
dsave(5) = the machine precision epsmch generated by the code; </li>
<li>
dsave(7) = the accumulated time spent on searching for Cauchy points; </li>
<li>
dsave(8) = the accumulated time spent on subspace minimization; </li>
<li>
dsave(9) = the accumulated time spent on line search; </li>
<li>
dsave(11) = the slope of the line search function at the current point of line search; </li>
<li>
dsave(12) = the maximum relative step length imposed in line search; </li>
<li>
dsave(13) = the infinity norm of the projected gradient; </li>
<li>
dsave(14) = the relative step length in the line search; </li>
<li>
dsave(15) = the slope of the line search function at the starting point of the line search; </li>
<li>
dsave(16) = the square of the 2-norm of the line search direction vector.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="setulb_8f_source.html#l00138">138</a> of file <a class="el" href="setulb_8f_source.html">setulb.f</a>.</p>

<p class="reference">References <a class="el" href="mainlb_8f.html#a5a0132dc055b1aade2710adfff9b8f09">mainlb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setulb_8f_a98990772aba60ae5986ecbbcc015ebed_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="setulb_8f.html">setulb.f</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
