<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>L-BFGS-B: src/cauchy.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">L-BFGS-B
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">Large-scale Bound-constrained Optimization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('cauchy_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">cauchy.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="cauchy_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ade50ac4208f509bdc3d04a325285a8be"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cauchy_8f.html#ade50ac4208f509bdc3d04a325285a8be">cauchy</a> (n, x, l, u, nbd, g, iorder, iwhere, t, d, xcp, m, wy, ws, sy, wt, theta, col, head, p, c, wbp, v, nseg, iprint, sbgnrm, info, epsmch)</td></tr>
<tr class="memdesc:ade50ac4208f509bdc3d04a325285a8be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the Generalized Cauchy Point along the projected gradient direction.  <a href="cauchy_8f.html#ade50ac4208f509bdc3d04a325285a8be">More...</a><br /></td></tr>
<tr class="separator:ade50ac4208f509bdc3d04a325285a8be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ade50ac4208f509bdc3d04a325285a8be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade50ac4208f509bdc3d04a325285a8be">&#9670;&nbsp;</a></span>cauchy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cauchy </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n)&#160;</td>
          <td class="paramname"><em>nbd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n)&#160;</td>
          <td class="paramname"><em>iorder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(n)&#160;</td>
          <td class="paramname"><em>iwhere</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n)&#160;</td>
          <td class="paramname"><em>xcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n, col)&#160;</td>
          <td class="paramname"><em>wy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(n, col)&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(m, m)&#160;</td>
          <td class="paramname"><em>sy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(m, m)&#160;</td>
          <td class="paramname"><em>wt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>head</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(2*m)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(2*m)&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(2*m)&#160;</td>
          <td class="paramname"><em>wbp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(2*m)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>nseg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iprint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>sbgnrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>epsmch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>For given x, l, u, g (with sbgnrm &gt; 0), and a limited memory BFGS matrix B defined in terms of matrices WY, WS, WT, and scalars head, col, and theta, this subroutine computes the generalized Cauchy point (GCP), defined as the first local minimizer of the quadratic </p><pre class="fragment">       Q(x + s) = g's + 1/2 s'Bs
</pre><p> along the projected gradient direction P(x-tg,l,u). The routine returns the GCP in xcp.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>On entry n is the dimension of the problem.<br  />
 On exit n is unchanged.</td></tr>
    <tr><td class="paramname">x</td><td>On entry x is the starting point for the GCP computation.<br  />
 On exit x is unchanged.</td></tr>
    <tr><td class="paramname">l</td><td>On entry l is the lower bound of x.<br  />
 On exit l is unchanged.</td></tr>
    <tr><td class="paramname">u</td><td>On entry u is the upper bound of x.<br  />
 On exit u is unchanged.</td></tr>
    <tr><td class="paramname">nbd</td><td>On entry nbd represents the type of bounds imposed on the variables, and must be specified as follows: nbd(i)=<ul>
<li>
0 if x(i) is unbounded, </li>
<li>
1 if x(i) has only a lower bound, </li>
<li>
2 if x(i) has both lower and upper bounds, and </li>
<li>
3 if x(i) has only an upper bound.</li>
</ul>
On exit nbd is unchanged.</td></tr>
    <tr><td class="paramname">g</td><td>On entry g is the gradient of f(x). g must be a nonzero vector.<br  />
 On exit g is unchanged.</td></tr>
    <tr><td class="paramname">iorder</td><td>iorder will be used to store the breakpoints in the piecewise linear path and free variables encountered.<br  />
 On exit,<ul>
<li>
iorder(1),...,iorder(nleft) are indices of breakpoints which have not been encountered; </li>
<li>
iorder(nleft+1),...,iorder(nbreak) are indices of encountered breakpoints; and </li>
<li>
iorder(nfree),...,iorder(n) are indices of variables which have no bound constraits along the search direction.</li>
</ul>
</td></tr>
    <tr><td class="paramname">iwhere</td><td>On entry iwhere indicates only the permanently fixed (iwhere=3) or free (iwhere= -1) components of x.<br  />
 On exit iwhere records the status of the current x variables. iwhere(i)=<ul>
<li>
-3 if x(i) is free and has bounds, but is not moved </li>
<li>
0 if x(i) is free and has bounds, and is moved </li>
<li>
1 if x(i) is fixed at l(i), and l(i) .ne. u(i) </li>
<li>
2 if x(i) is fixed at u(i), and u(i) .ne. l(i) </li>
<li>
3 if x(i) is always fixed, i.e., u(i)=x(i)=l(i) </li>
<li>
-1 if x(i) is always free, i.e., it has no bounds.</li>
</ul>
</td></tr>
    <tr><td class="paramname">t</td><td>working array; will be used to store the break points.</td></tr>
    <tr><td class="paramname">d</td><td>the Cauchy direction P(x-tg)-x</td></tr>
    <tr><td class="paramname">xcp</td><td>returns the GCP on exit</td></tr>
    <tr><td class="paramname">m</td><td>On entry m is the maximum number of variable metric corrections used to define the limited memory matrix.<br  />
 On exit m is unchanged.</td></tr>
    <tr><td class="paramname">ws</td><td>On entry this stores S, a set of s-vectors, that defines the limited memory BFGS matrix.<br  />
 On exit this array is unchanged.</td></tr>
    <tr><td class="paramname">wy</td><td>On entry this stores Y, a set of y-vectors, that defines the limited memory BFGS matrix.<br  />
 On exit this array is unchanged.</td></tr>
    <tr><td class="paramname">sy</td><td>On entry this stores S'Y, that defines the limited memory BFGS matrix.<br  />
 On exit this array is unchanged.</td></tr>
    <tr><td class="paramname">wt</td><td>On entry this stores the Cholesky factorization of (theta*S'S+LD^(-1)L'), that defines the limited memory BFGS matrix.<br  />
 On exit this array is unchanged.</td></tr>
    <tr><td class="paramname">theta</td><td>On entry theta is the scaling factor specifying B_0 = theta I.<br  />
 On exit theta is unchanged.</td></tr>
    <tr><td class="paramname">col</td><td>On entry col is the actual number of variable metric corrections stored so far.<br  />
 On exit col is unchanged.</td></tr>
    <tr><td class="paramname">head</td><td>On entry head is the location of the first s-vector (or y-vector) in S (or Y).<br  />
 On exit col is unchanged.</td></tr>
    <tr><td class="paramname">p</td><td>will be used to store the vector p = W^(T)d.</td></tr>
    <tr><td class="paramname">c</td><td>will be used to store the vector c = W^(T)(xcp-x).</td></tr>
    <tr><td class="paramname">wbp</td><td>will be used to store the row of W corresponding to a breakpoint.</td></tr>
    <tr><td class="paramname">v</td><td>working array</td></tr>
    <tr><td class="paramname">nseg</td><td>On exit nseg records the number of quadratic segments explored in searching for the GCP.</td></tr>
    <tr><td class="paramname">iprint</td><td>variable that must be set by the user.<br  />
 It controls the frequency and type of output generated: <ul>
<li>
iprint&lt;0 no output is generated; </li>
<li>
iprint=0 print only one line at the last iteration; </li>
<li>
0&lt;iprint&lt;99 print also f and |proj g| every iprint iterations; </li>
<li>
iprint=99 print details of every iteration except n-vectors; </li>
<li>
iprint=100 print also the changes of active set and final x; </li>
<li>
iprint&gt;100 print details of every iteration including x and g;</li>
</ul>
When iprint &gt; 0, the file iterate.dat will be created to summarize the iteration.</td></tr>
    <tr><td class="paramname">sbgnrm</td><td>On entry sbgnrm is the norm of the projected gradient at x.<br  />
 On exit sbgnrm is unchanged.</td></tr>
    <tr><td class="paramname">info</td><td>On entry info is 0. On exit info =<ul>
<li>
0 for normal return, </li>
<li>
= nonzero for abnormal return when the the system used in routine bmv is singular.</li>
</ul>
</td></tr>
    <tr><td class="paramname">epsmch</td><td>machine precision epsilon </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="cauchy_8f_source.html#l00130">130</a> of file <a class="el" href="cauchy_8f_source.html">cauchy.f</a>.</p>

<p class="reference">References <a class="el" href="bmv_8f.html#a3b7cf8256f5c958dd10a7f72db1a0f14">bmv()</a>, and <a class="el" href="hpsolb_8f.html#a94349c617519970019d2f15efcb1df41">hpsolb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mainlb_8f.html#a5a0132dc055b1aade2710adfff9b8f09">mainlb()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cauchy_8f_ade50ac4208f509bdc3d04a325285a8be_cgraph.svg" width="182" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="cauchy_8f_ade50ac4208f509bdc3d04a325285a8be_icgraph.svg" width="287" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="cauchy_8f.html">cauchy.f</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
